{"version":3,"sources":["turbopack:///[project]/projects/ticketing-platform/lib/services/notificationService.ts"],"sourcesContent":["/**\n * Notification Service\n * Wrapper around emailService.ts for ticketing system notifications\n * Handles all email notifications for requests, assignments, status updates\n */\n\nimport emailService, { Language } from \"../../services/emailService\";\nimport { logger } from \"../utils/logger\";\n\n/**\n * Request notification data interface\n */\nexport interface RequestNotificationData {\n  requestNumber: string;\n  requestId: number;\n  customerName: string;\n  customerEmail: string;\n  partnerName: string;\n  partnerEmail: string;\n  branchName: string;\n  branchAddress: string;\n  serviceName: string;\n  categoryName: string;\n  status: string;\n  notes?: string;\n  rejectionReason?: string;\n}\n\n/**\n * Notification Service Class\n */\nclass NotificationService {\n  /**\n   * Send email when admin assigns request to partner\n   * @param data Request and partner information\n   * @param language Partner's preferred language\n   */\n  async sendRequestAssignedEmail(\n    data: RequestNotificationData,\n    language: Language = \"en\"\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const timeLimit = 15; // minutes\n\n      const content = {\n        ar: {\n          subject: `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ ØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡ - ${data.requestNumber}`,\n          message: `ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯ Ù„Ùƒ.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\nØ§Ù„ÙØ¦Ø©: ${data.categoryName}\nØ§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ù…ÙˆÙ‚Ø¹: ${data.branchAddress}\n\nâ° Ù…Ù‡Ù…: ÙŠØ±Ø¬Ù‰ Ù‚Ø¨ÙˆÙ„ Ø£Ùˆ Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨ Ø®Ù„Ø§Ù„ ${timeLimit} Ø¯Ù‚ÙŠÙ‚Ø©.\n\nØ³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨.`,\n        },\n        en: {\n          subject: `New Request Assigned - ${data.requestNumber}`,\n          message: `A new service request has been assigned to you.\n\nRequest Number: ${data.requestNumber}\nBranch: ${data.branchName}\nService: ${data.serviceName}\nCategory: ${data.categoryName}\nCustomer Name: ${data.customerName}\nLocation: ${data.branchAddress}\n\nâ° Important: Please accept or reject this request within ${timeLimit} minutes.\n\nLog in to your dashboard to respond to this request.`,\n        },\n      };\n\n      const result = await emailService.sendNotificationEmail(\n        data.partnerEmail,\n        content[language].subject,\n        content[language].message,\n        language\n      );\n\n      if (result.success) {\n        logger.info(\"Request assigned email sent\", {\n          requestId: data.requestId,\n          recipient: data.partnerEmail,\n        });\n      }\n\n      return result;\n    } catch (error) {\n      logger.error(\"Failed to send request assigned email\", {\n        error,\n        requestId: data.requestId,\n      });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n\n  /**\n   * Send email when partner accepts request\n   * @param data Request information\n   * @param adminEmail Admin email to notify\n   * @param language Language preference\n   */\n  async sendRequestAcceptedEmail(\n    data: RequestNotificationData,\n    adminEmail: string,\n    language: Language = \"en\"\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const content = {\n        ar: {\n          adminSubject: `ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          adminMessage: `Ù‚Ø§Ù… ${data.partnerName} Ø¨Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}`,\n          customerSubject: `ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ - ${data.requestNumber}`,\n          customerMessage: `ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\nØ§Ù„Ø¹Ù†ÙˆØ§Ù†: ${data.branchAddress}\n\nØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø®Ø¯Ù…Ø©.`,\n        },\n        en: {\n          adminSubject: `Request Accepted - ${data.requestNumber}`,\n          adminMessage: `${data.partnerName} has accepted the request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}`,\n          customerSubject: `Your Request is Confirmed - ${data.requestNumber}`,\n          customerMessage: `Your service request has been confirmed.\n\nRequest Number: ${data.requestNumber}\nBranch: ${data.branchName}\nService: ${data.serviceName}\nAddress: ${data.branchAddress}\n\nYou will be contacted soon to coordinate the service.`,\n        },\n      };\n\n      // Send to admin\n      logger.info(\"Attempting to send acceptance email to admin\", {\n        adminEmail,\n        requestId: data.requestId,\n      });\n\n      const adminResult = await emailService.sendNotificationEmail(\n        adminEmail,\n        content[language].adminSubject,\n        content[language].adminMessage,\n        language\n      );\n\n      logger.info(\"Admin email result\", {\n        success: adminResult.success,\n        error: adminResult.error,\n        requestId: data.requestId,\n      });\n\n      // Send to customer only if email is valid and not a system email\n      let customerResult = { success: true };\n\n      if (\n        data.customerEmail &&\n        !data.customerEmail.includes(\"external@system.internal\") &&\n        data.customerEmail.includes(\"@\")\n      ) {\n        logger.info(\"Attempting to send acceptance email to customer\", {\n          customerEmail: data.customerEmail,\n          requestId: data.requestId,\n        });\n\n        customerResult = await emailService.sendNotificationEmail(\n          data.customerEmail,\n          content[language].customerSubject,\n          content[language].customerMessage,\n          language\n        );\n\n        logger.info(\"Customer email result\", {\n          success: customerResult.success,\n          requestId: data.requestId,\n        });\n      } else {\n        logger.info(\"Skipping customer email (invalid or system email)\", {\n          customerEmail: data.customerEmail,\n          requestId: data.requestId,\n        });\n      }\n\n      const success = adminResult.success && customerResult.success;\n\n      if (success) {\n        logger.info(\"Request accepted emails sent\", {\n          requestId: data.requestId,\n          recipients: [adminEmail, data.customerEmail],\n        });\n      } else {\n        logger.error(\"Failed to send some acceptance emails\", {\n          requestId: data.requestId,\n          adminResult,\n          customerResult,\n        });\n      }\n\n      return {\n        success,\n        error: !success\n          ? `Admin: ${adminResult.error || \"OK\"}, Customer: ${\n              customerResult.success ? \"OK\" : \"Failed\"\n            }`\n          : undefined,\n      };\n    } catch (error) {\n      logger.error(\"Failed to send request accepted emails\", {\n        error,\n        requestId: data.requestId,\n      });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n\n  /**\n   * Send email when partner rejects request\n   * @param data Request information with rejection reason\n   * @param adminEmail Admin email to notify\n   * @param language Language preference\n   */\n  async sendRequestRejectedEmail(\n    data: RequestNotificationData,\n    adminEmail: string,\n    language: Language = \"en\"\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const content = {\n        ar: {\n          subject: `ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          message: `Ù‚Ø§Ù… ${data.partnerName} Ø¨Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\nØ³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶: ${data.rejectionReason || \"Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø¨Ø¨\"}\n\nÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø·Ù„Ø¨ Ù„Ø´Ø±ÙŠÙƒ Ø¢Ø®Ø±.`,\n        },\n        en: {\n          subject: `Request Rejected - ${data.requestNumber}`,\n          message: `${data.partnerName} has rejected the request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}\n\nRejection Reason: ${data.rejectionReason || \"No reason provided\"}\n\nPlease reassign the request to another partner.`,\n        },\n      };\n\n      const result = await emailService.sendNotificationEmail(\n        adminEmail,\n        content[language].subject,\n        content[language].message,\n        language\n      );\n\n      if (result.success) {\n        logger.info(\"Request rejected email sent\", {\n          requestId: data.requestId,\n          recipient: adminEmail,\n        });\n      }\n\n      return result;\n    } catch (error) {\n      logger.error(\"Failed to send request rejected email\", {\n        error,\n        requestId: data.requestId,\n      });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n\n  /**\n   * Dynamic status-specific email templates\n   * Add new statuses here without creating new methods\n   */\n  private getStatusEmailContent(status: string, data: RequestNotificationData) {\n    const statusTemplates: Record<\n      string,\n      {\n        ar: {\n          customerSubject: string;\n          customerMessage: string;\n          adminSubject: string;\n          adminMessage: string;\n        };\n        en: {\n          customerSubject: string;\n          customerMessage: string;\n          adminSubject: string;\n          adminMessage: string;\n        };\n      }\n    > = {\n      in_progress: {\n        ar: {\n          customerSubject: `Ø§Ù„Ø¹Ù…Ù„ Ø¬Ø§Ø±Ù Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ - ${data.requestNumber}`,\n          customerMessage: `Ø¨Ø¯Ø£ ${\n            data.partnerName\n          } Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${\n  data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}\\n\\n` : \"\"\n}Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø¨Ø´Ø£Ù† Ø£ÙŠ ØªØ­Ø¯ÙŠØ«Ø§Øª.`,\n          adminSubject: `Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          adminMessage: `Ø¨Ø¯Ø£ ${data.partnerName} Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}` : \"Ø§Ù„Ø­Ø§Ù„Ø©: Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°\"}`,\n        },\n        en: {\n          customerSubject: `Work Started on Your Request - ${data.requestNumber}`,\n          customerMessage: `${\n            data.partnerName\n          } has started working on your service request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nService: ${data.serviceName}\n\n${\n  data.notes ? `Notes: ${data.notes}\\n\\n` : \"\"\n}You will be contacted soon with any updates.`,\n          adminSubject: `Work Started on Request - ${data.requestNumber}`,\n          adminMessage: `${data.partnerName} has started working on the request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}\n\n${data.notes ? `Notes: ${data.notes}` : \"Status: In Progress\"}`,\n        },\n      },\n      completed: {\n        ar: {\n          customerSubject: `Ø§ÙƒØªÙ…Ù„ Ø·Ù„Ø¨Ùƒ - ${data.requestNumber}`,\n          customerMessage: `Ø£ÙƒÙ…Ù„ ${data.partnerName} Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}\\n\\n` : \"\"}ÙŠØ±Ø¬Ù‰ ØªÙ‚ÙŠÙŠÙ… ØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹Ù†Ø§!\n\nØ³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©.`,\n          adminSubject: `Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          adminMessage: `Ø£ÙƒÙ…Ù„ ${data.partnerName} Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${\n  data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}\\n\\n` : \"\"\n}âš ï¸ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚: ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ù† Ø§Ù„Ø®Ø¯Ù…Ø© Ø§ÙƒØªÙ…Ù„Øª Ø¨Ø´ÙƒÙ„ Ù…Ø±Ø¶Ù.`,\n        },\n        en: {\n          customerSubject: `Your Request is Completed - ${data.requestNumber}`,\n          customerMessage: `${\n            data.partnerName\n          } has completed your service request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nService: ${data.serviceName}\n\n${\n  data.notes ? `Notes: ${data.notes}\\n\\n` : \"\"\n}Please rate your experience with us!\n\nLog in to your account to rate the service.`,\n          adminSubject: `Request Completed - ${data.requestNumber}`,\n          adminMessage: `${data.partnerName} has completed work on the request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}\n\n${\n  data.notes ? `Notes: ${data.notes}\\n\\n` : \"\"\n}âš ï¸ Verification Needed: Please confirm with customer that the service was completed satisfactorily.`,\n        },\n      },\n      confirmed: {\n        ar: {\n          customerSubject: `ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ - ${data.requestNumber}`,\n          customerMessage: `Ù‚Ø§Ù… ${data.partnerName} Ø¨ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\nØ§Ù„Ø¹Ù†ÙˆØ§Ù†: ${data.branchAddress}\n\n${data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}\\n\\n` : \"\"}Ø³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.`,\n          adminSubject: `ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          adminMessage: `Ù‚Ø§Ù… ${data.partnerName} Ø¨ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}` : \"Ø§Ù„Ø­Ø§Ù„Ø©: Ù…Ø¤ÙƒØ¯\"}`,\n        },\n        en: {\n          customerSubject: `Your Request is Confirmed - ${data.requestNumber}`,\n          customerMessage: `${\n            data.partnerName\n          } has confirmed your service request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nService: ${data.serviceName}\nAddress: ${data.branchAddress}\n\n${\n  data.notes ? `Notes: ${data.notes}\\n\\n` : \"\"\n}Work on your request will begin soon.`,\n          adminSubject: `Request Confirmed - ${data.requestNumber}`,\n          adminMessage: `${data.partnerName} has confirmed the request.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}\n\n${data.notes ? `Notes: ${data.notes}` : \"Status: Confirmed\"}`,\n        },\n      },\n      closed: {\n        ar: {\n          customerSubject: `ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø·Ù„Ø¨Ùƒ - ${data.requestNumber}`,\n          customerMessage: `ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}\\n\\n` : \"\"}Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø§ØªÙ†Ø§!`,\n          adminSubject: `ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          adminMessage: `ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø·Ù„Ø¨.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}` : \"Ø§Ù„Ø­Ø§Ù„Ø©: Ù…ØºÙ„Ù‚\"}`,\n        },\n        en: {\n          customerSubject: `Your Request is Closed - ${data.requestNumber}`,\n          customerMessage: `Your service request has been closed.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nService: ${data.serviceName}\n\n${\n  data.notes ? `Notes: ${data.notes}\\n\\n` : \"\"\n}Thank you for using our services!`,\n          adminSubject: `Request Closed - ${data.requestNumber}`,\n          adminMessage: `The request has been closed.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}\n\n${data.notes ? `Notes: ${data.notes}` : \"Status: Closed\"}`,\n        },\n      },\n    };\n\n    // Return template for status, or generic template if status not found\n    return (\n      statusTemplates[status] || {\n        ar: {\n          customerSubject: `ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          customerMessage: `ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¥Ù„Ù‰: ${status}\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${\n  data.notes\n    ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}`\n    : \"Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…Ù„Ø©.\"\n}`,\n          adminSubject: `ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ - ${data.requestNumber}`,\n          adminMessage: `ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰: ${status}\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\n${data.notes ? `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${data.notes}` : `Ø§Ù„Ø­Ø§Ù„Ø©: ${status}`}`,\n        },\n        en: {\n          customerSubject: `Request Status Update - ${data.requestNumber}`,\n          customerMessage: `Your service request status has been updated to: ${status}\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nService: ${data.serviceName}\n\n${\n  data.notes ? `Notes: ${data.notes}` : \"Log in to view full request details.\"\n}`,\n          adminSubject: `Request Status Update - ${data.requestNumber}`,\n          adminMessage: `The request status has been updated to: ${status}\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}\n\n${data.notes ? `Notes: ${data.notes}` : `Status: ${status}`}`,\n        },\n      }\n    );\n  }\n\n  /**\n   * Send dynamic status change email (works for any status)\n   * @param data Request information\n   * @param status New status of the request\n   * @param adminEmail Admin email to notify\n   * @param language Language preference\n   */\n  async sendStatusChangeEmail(\n    data: RequestNotificationData,\n    status: string,\n    adminEmail: string,\n    language: Language = \"en\"\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      // Get dynamic content based on status\n      const content = this.getStatusEmailContent(status, data);\n\n      // Send to customer (skip if external/system email)\n      let customerResult = { success: true };\n      if (\n        data.customerEmail &&\n        !data.customerEmail.includes(\"external@system.internal\") &&\n        data.customerEmail.includes(\"@\")\n      ) {\n        logger.info(`Sending ${status} email to customer`, {\n          customerEmail: data.customerEmail,\n          requestId: data.requestId,\n          status,\n        });\n\n        customerResult = await emailService.sendNotificationEmail(\n          data.customerEmail,\n          content[language].customerSubject,\n          content[language].customerMessage,\n          language\n        );\n      }\n\n      // Send to admin\n      logger.info(`Sending ${status} email to admin`, {\n        adminEmail,\n        requestId: data.requestId,\n        status,\n      });\n\n      const adminResult = await emailService.sendNotificationEmail(\n        adminEmail,\n        content[language].adminSubject,\n        content[language].adminMessage,\n        language\n      );\n\n      const success = customerResult.success && adminResult.success;\n\n      if (success) {\n        logger.info(`${status} status emails sent successfully`, {\n          requestId: data.requestId,\n          recipients: [adminEmail, data.customerEmail],\n          status,\n        });\n      }\n\n      return {\n        success,\n        error: !success\n          ? `Admin: ${adminResult.error || \"OK\"}, Customer: ${\n              customerResult.success ? \"OK\" : \"Failed\"\n            }`\n          : undefined,\n      };\n    } catch (error) {\n      logger.error(`Failed to send ${status} status emails`, {\n        error,\n        requestId: data.requestId,\n        status,\n      });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n\n  /**\n   * Send email when confirmation timer expires\n   * @param data Request information\n   * @param adminEmail Admin email to notify\n   * @param language Language preference\n   */\n  async sendTimerExpiredEmail(\n    data: RequestNotificationData,\n    adminEmail: string,\n    language: Language = \"en\"\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const content = {\n        ar: {\n          subject: `Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ - ${data.requestNumber}`,\n          message: `Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ù‡Ù„Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ù‚Ø¨Ù„ ${data.partnerName}.\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${data.requestNumber}\nØ§Ù„Ø´Ø±ÙŠÙƒ: ${data.partnerName}\nØ§Ù„ÙØ±Ø¹: ${data.branchName}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${data.customerName}\nØ§Ù„Ø®Ø¯Ù…Ø©: ${data.serviceName}\n\nÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø·Ù„Ø¨ Ù„Ø´Ø±ÙŠÙƒ Ø¢Ø®Ø±.`,\n        },\n        en: {\n          subject: `Confirmation Timer Expired - ${data.requestNumber}`,\n          message: `The confirmation timer has expired for ${data.partnerName}.\n\nRequest Number: ${data.requestNumber}\nPartner: ${data.partnerName}\nBranch: ${data.branchName}\nCustomer: ${data.customerName}\nService: ${data.serviceName}\n\nPlease reassign the request to another partner.`,\n        },\n      };\n\n      const result = await emailService.sendNotificationEmail(\n        adminEmail,\n        content[language].subject,\n        content[language].message,\n        language\n      );\n\n      if (result.success) {\n        logger.info(\"Timer expired email sent\", {\n          requestId: data.requestId,\n          recipient: adminEmail,\n        });\n      }\n\n      return result;\n    } catch (error) {\n      logger.error(\"Failed to send timer expired email\", {\n        error,\n        requestId: data.requestId,\n      });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n\n  /**\n   * Send email when SLA timeout occurs\n   * Bilingual notification sent to admin and operational team when partner doesn't respond in time\n   * @param data SLA timeout information with multiple recipients\n   */\n  async sendSlaTimeoutEmail(data: {\n    requestNumber: string;\n    partnerName: string;\n    recipients: string[];\n    slaDeadline?: Date | string | null;\n    assignedAt?: Date | string | null;\n  }): Promise<{ success: boolean; error?: string }> {\n    try {\n      // Calculate timeout duration if possible\n      let timeoutDuration = \"\";\n      if (data.slaDeadline && data.assignedAt) {\n        const deadline =\n          typeof data.slaDeadline === \"string\"\n            ? new Date(data.slaDeadline)\n            : data.slaDeadline;\n        const assigned =\n          typeof data.assignedAt === \"string\"\n            ? new Date(data.assignedAt)\n            : data.assignedAt;\n        const minutes = Math.round(\n          (deadline.getTime() - assigned.getTime()) / (1000 * 60)\n        );\n        timeoutDuration = `${minutes} minutes`;\n      }\n\n      // English version\n      const subjectEN = `â° SLA Timeout Alert - Request ${data.requestNumber}`;\n      const messageEN = `<div style=\"font-family: Arial, sans-serif; padding: 20px; background-color: #f9fafb; border-radius: 8px; direction: ltr;\">\n  <div style=\"background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\">\n    <h2 style=\"color: #dc2626; margin-top: 0;\">â° SLA Timeout Alert</h2>\n    \n    <p style=\"font-size: 16px; color: #374151; line-height: 1.6;\">\n      Request <strong style=\"color: #6366f1;\">${\n        data.requestNumber\n      }</strong> has been automatically unassigned.\n    </p>\n    \n    <div style=\"background-color: #fef2f2; border-left: 4px solid #dc2626; padding: 15px; margin: 20px 0;\">\n      <p style=\"margin: 0; color: #991b1b; font-weight: 500;\">\n        Partner <strong>${\n          data.partnerName\n        }</strong> did not respond within the ${\n        timeoutDuration || \"configured SLA\"\n      } deadline.\n      </p>\n    </div>\n    \n    <div style=\"background-color: #f3f4f6; padding: 15px; border-radius: 6px; margin: 20px 0;\">\n      <h3 style=\"margin-top: 0; font-size: 16px; color: #374151;\">Next Steps:</h3>\n      <ul style=\"color: #6b7280; line-height: 1.8; margin: 0;\">\n        <li>The request is now back in the <strong>unassigned queue</strong></li>\n        <li>Please reassign to another available partner</li>\n        <li>Consider reviewing partner response rates</li>\n      </ul>\n    </div>\n    \n    <p style=\"color: #6b7280; margin-top: 30px; font-size: 14px;\">\n      This is an automated notification from the ticketing system.\n    </p>\n  </div>\n</div>`;\n\n      // Arabic version\n      const subjectAR = `â° ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù†ØªÙ‡Ø§Ø¡ ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© - Ø·Ù„Ø¨ ${data.requestNumber}`;\n      const messageAR = `<div style=\"font-family: 'Tahoma', 'Arial Unicode MS', Arial, sans-serif; padding: 20px; background-color: #f9fafb; border-radius: 8px; direction: rtl; text-align: right;\">\n  <div style=\"background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);\">\n    <h2 style=\"color: #dc2626; margin-top: 0;\">â° ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù†ØªÙ‡Ø§Ø¡ ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©</h2>\n    \n    <p style=\"font-size: 16px; color: #374151; line-height: 1.6;\">\n      ØªÙ… Ø¥Ù„ØºØ§Ø¡ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø·Ù„Ø¨ <strong style=\"color: #6366f1;\">${\n        data.requestNumber\n      }</strong> ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.\n    </p>\n    \n    <div style=\"background-color: #fef2f2; border-right: 4px solid #dc2626; padding: 15px; margin: 20px 0;\">\n      <p style=\"margin: 0; color: #991b1b; font-weight: 500;\">\n        Ø§Ù„Ø´Ø±ÙŠÙƒ <strong>${data.partnerName}</strong> Ù„Ù… ÙŠØ³ØªØ¬Ø¨ Ø®Ù„Ø§Ù„ ${\n        timeoutDuration\n          ? \"Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© \" + timeoutDuration\n          : \"Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø®Ø¯Ù…Ø©\"\n      }.\n      </p>\n    </div>\n    \n    <div style=\"background-color: #f3f4f6; padding: 15px; border-radius: 6px; margin: 20px 0;\">\n      <h3 style=\"margin-top: 0; font-size: 16px; color: #374151;\">Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</h3>\n      <ul style=\"color: #6b7280; line-height: 1.8; margin: 0;\">\n        <li>Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ÙÙŠ <strong>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø¹ÙŠÙ†Ø©</strong></li>\n        <li>ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†Ù‡ Ù„Ø´Ø±ÙŠÙƒ Ø¢Ø®Ø± Ù…ØªØ§Ø­</li>\n        <li>ÙŠÙÙ†ØµØ­ Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ§Ø¡</li>\n      </ul>\n    </div>\n    \n    <p style=\"color: #6b7280; margin-top: 30px; font-size: 14px;\">\n      Ù‡Ø°Ø§ Ø¥Ø´Ø¹Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ°Ø§ÙƒØ±.\n    </p>\n  </div>\n</div>`;\n\n      // Combine both languages\n      const combinedSubject = `${subjectEN} | ${subjectAR}`;\n      const combinedMessage = `\n        <div style=\"max-width: 600px; margin: 0 auto;\">\n          <h1 style=\"text-align: center; color: #dc2626; font-size: 20px; padding: 20px 0;\">\n            ğŸš¨ SLA Timeout / Ø§Ù†ØªÙ‡Ø§Ø¡ ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© ğŸš¨\n          </h1>\n          \n          <!-- English Version -->\n          ${messageEN}\n          \n          <hr style=\"margin: 40px 0; border: none; border-top: 2px solid #e5e7eb;\">\n          \n          <!-- Arabic Version -->\n          ${messageAR}\n        </div>\n      `;\n\n      // Send to all recipients\n      const result = await emailService.sendEmail({\n        to: data.recipients,\n        subject: combinedSubject,\n        html: combinedMessage,\n      });\n\n      if (result.success) {\n        logger.info(\"SLA timeout email sent\", {\n          requestNumber: data.requestNumber,\n          recipients: data.recipients,\n          recipientCount: data.recipients.length,\n        });\n      }\n\n      return result;\n    } catch (error) {\n      logger.error(\"Failed to send SLA timeout email\", {\n        error,\n        requestNumber: data.requestNumber,\n      });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n\n  /**\n   * Generic method to send notification emails\n   * @param to Recipient email\n   * @param subject Email subject\n   * @param message Email message body\n   * @param language Language preference\n   */\n  async sendNotificationEmail(\n    to: string,\n    subject: string,\n    message: string,\n    language: Language = \"en\"\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const result = await emailService.sendNotificationEmail(\n        to,\n        subject,\n        message,\n        language\n      );\n\n      if (result.success) {\n        logger.info(\"Notification email sent\", {\n          recipient: to,\n          subject,\n        });\n      }\n\n      return result;\n    } catch (error) {\n      logger.error(\"Failed to send notification email\", {\n        error,\n        recipient: to,\n      });\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\",\n      };\n    }\n  }\n}\n\n// Create and export a singleton instance\nconst notificationService = new NotificationService();\nexport default notificationService;\n\n// Export the class for testing purposes\nexport { NotificationService };\n"],"names":[],"mappings":"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"}