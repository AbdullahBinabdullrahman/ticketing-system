module.exports=[360,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(47750),f=a.i(7116),g=a.i(15742),h=a.i(88410),i=a.i(15559),j=a.i(88481),k=a.i(24413),l=a.i(64644),m=a.i(34791),n=b([e,l,m]);function o({timeline:a,className:b}){let{t:c,i18n:n}=(0,e.useTranslation)("common");return a&&0!==a.length?(0,d.jsx)("div",{className:(0,l.cn)("space-y-4",b),dir:"ar"===n.language?"rtl":"ltr",children:a.map((b,e)=>(0,d.jsxs)(m.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*e},className:"flex gap-4",children:[(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("div",{className:(0,l.cn)("w-10 h-10 rounded-full flex items-center justify-center text-white shadow-md",(a=>{switch(a){case"submitted":return"bg-gray-500";case"assigned":return"bg-yellow-500";case"confirmed":return"bg-blue-500";case"in_progress":return"bg-purple-500";case"completed":return"bg-green-500";case"closed":return"bg-teal-500";case"rejected":return"bg-red-500";default:return"bg-gray-400"}})(b.status)),children:(a=>{switch(a){case"submitted":return(0,d.jsx)(k.Package,{className:"h-4 w-4"});case"assigned":return(0,d.jsx)(h.User,{className:"h-4 w-4"});case"confirmed":case"completed":case"closed":return(0,d.jsx)(i.CheckCircle,{className:"h-4 w-4"});case"in_progress":default:return(0,d.jsx)(g.Clock,{className:"h-4 w-4"});case"rejected":return(0,d.jsx)(j.XCircle,{className:"h-4 w-4"})}})(b.status)}),e<a.length-1&&(0,d.jsx)("div",{className:"w-0.5 h-full bg-gray-200 dark:bg-gray-700 mt-2"})]}),(0,d.jsx)("div",{className:"flex-1 pb-8",children:(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-2",children:[(0,d.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:c(`requests.${b.status}`)}),(0,d.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap",children:(0,f.format)(new Date(b.createdAt),"PPp")})]}),b.statusNotes&&(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:b.statusNotes}),b.createdBy&&(0,d.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-500",children:[(0,d.jsx)(h.User,{className:"h-3 w-3"}),(0,d.jsxs)("span",{children:[c("common.by")," ",b.createdBy.name]}),(0,d.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-xs",children:b.createdBy.userType})]})]})})]},b.id))}):(0,d.jsxs)("div",{className:(0,l.cn)("text-center py-8",b),children:[(0,d.jsx)(g.Clock,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:c("requests.noTimeline")||"No timeline data available"})]})}[e,l,m]=n.then?(await n)():n,a.s(["default",()=>o]),c()}catch(a){c(a)}},!1),97392,a=>{"use strict";let b=(0,a.i(13792).default)("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);a.s(["MapIcon",()=>b],97392)},22230,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(14229),g=a.i(47750),h=a.i(7116),i=a.i(79336),j=a.i(61462),k=a.i(360),l=a.i(15022),m=a.i(88410),n=a.i(81958),o=a.i(3750),p=a.i(40128),q=a.i(15742),r=a.i(15559),s=a.i(88481),t=a.i(24917),u=a.i(1161),v=a.i(97392),w=a.i(93265),x=a.i(54006),y=a.i(88925),z=a.i(75627),A=a.i(62806),B=a.i(33292),C=a.i(73632),D=a.i(4866),E=a.i(68382),F=b([g,i,j,k,y,z,A,B,C,D,E]);function G(){let a=(0,f.useRouter)(),{id:b}=a.query,{t:c,i18n:F}=(0,g.useTranslation)("common"),[G,H]=(0,e.useState)(null),[I,J]=(0,e.useState)([]),[K,L]=(0,e.useState)(!0),[M,N]=(0,e.useState)(!1),[O,P]=(0,e.useState)(!1),[Q,R]=(0,e.useState)(""),[S,T]=(0,e.useState)(!1),[U,V]=(0,e.useState)(!1),W=async()=>{try{L(!0);let[a,c]=await Promise.all([y.apiClient.get(`/admin/requests/${b}`),y.apiClient.get(`/admin/requests/${b}/timeline`)]);H(a.data.data.request),J(c.data.data.timeline||[])}catch(b){let a=c("errors.generic");b&&"object"==typeof b&&b.response?.data?.message&&(a=b.response.data.message),z.default.error(a)}finally{L(!1)}};(0,e.useEffect)(()=>{b&&W()},[b]);let X=async()=>{if(!S)return void z.default.error(c("requests.customerConfirmationRequired")||"Please confirm that the customer verified completion");try{V(!0),await E.default.post(`/api/admin/requests/${b}/close`,{verificationNotes:Q,customerConfirmed:S}),z.default.success(c("success.closed")),P(!1),await W()}catch(b){let a=b instanceof Error?b.message:String(b);z.default.error(a||c("errors.generic"))}finally{V(!1)}},Y=G?.status==="submitted"||G?.status==="unassigned",Z=G?.status==="completed";return K?(0,d.jsx)(i.default,{children:(0,d.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})})}):G?(0,d.jsxs)(i.default,{children:[(0,d.jsxs)("div",{dir:"ar"===F.language?"rtl":"ltr",children:[(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)(B.BlurFade,{delay:.1,children:(0,d.jsxs)("button",{onClick:()=>{a.push("/admin/requests")},className:"flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[(0,d.jsx)(u.ArrowLeft,{className:"h-5 w-5 mr-2"}),c("common.back")]})}),(0,d.jsx)(B.BlurFade,{delay:.2,children:(0,d.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2 flex items-center",children:[(a=>{switch(a){case"submitted":return(0,d.jsx)(l.FileText,{className:"h-5 w-5 text-blue-500"});case"assigned":return(0,d.jsx)(m.User,{className:"h-5 w-5 text-indigo-500"});case"confirmed":return(0,d.jsx)(r.CheckCircle,{className:"h-5 w-5 text-green-500"});case"in_progress":return(0,d.jsx)(q.Clock,{className:"h-5 w-5 text-yellow-500"});case"completed":return(0,d.jsx)(r.CheckCircle,{className:"h-5 w-5 text-emerald-500"});case"closed":return(0,d.jsx)(r.CheckCircle,{className:"h-5 w-5 text-gray-500"});case"rejected":return(0,d.jsx)(s.XCircle,{className:"h-5 w-5 text-red-500"});case"unassigned":return(0,d.jsx)(t.AlertCircle,{className:"h-5 w-5 text-orange-500"});default:return(0,d.jsx)(l.FileText,{className:"h-5 w-5 text-gray-500"})}})(G.status),(0,d.jsxs)("span",{className:"ml-3",children:[c("requests.requestNumber"),": ",G.requestNumber]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsx)(j.default,{status:G.status}),G.slaDeadline&&(0,d.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center",children:[(0,d.jsx)(q.Clock,{className:"h-4 w-4 mr-1"}),"SLA: ",(0,h.format)(new Date(G.slaDeadline),"PPP p")]})]})]}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mt-4 md:mt-0",children:[Y&&(0,d.jsx)(A.ShimmerButton,{onClick:()=>{N(!0)},children:c("requests.assignToPartner")}),Z&&(0,d.jsxs)(A.ShimmerButton,{onClick:()=>P(!0),background:"rgb(34, 197, 94)",children:[(0,d.jsx)(x.CheckCircle2,{className:"h-5 w-5 mr-2"}),c("requests.closeRequest")||"Close Request"]})]})]})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,d.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,d.jsx)(B.BlurFade,{delay:.3,children:(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:c("requests.requestDetails")}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.category")}),(0,d.jsx)("p",{className:"mt-1 text-gray-900 dark:text-white",children:G.categoryName})]}),G.serviceName&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.service")}),(0,d.jsx)("p",{className:"mt-1 text-gray-900 dark:text-white",children:G.serviceName})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("partners.pickupOptions")}),(0,d.jsx)("p",{className:"mt-1 text-gray-900 dark:text-white",children:G.pickupOptionName})]}),G.partnerName&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("partners.title")}),(0,d.jsxs)("p",{className:"mt-1 text-gray-900 dark:text-white flex items-center",children:[(0,d.jsx)(w.Building2,{className:"h-4 w-4 mr-2"}),G.partnerName]})]}),G.branchName&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("branches.title")}),(0,d.jsxs)("p",{className:"mt-1 text-gray-900 dark:text-white flex items-center",children:[(0,d.jsx)(o.MapPin,{className:"h-4 w-4 mr-2"}),G.branchName]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.submitted")}),(0,d.jsxs)("p",{className:"mt-1 text-gray-900 dark:text-white flex items-center",children:[(0,d.jsx)(p.Calendar,{className:"h-4 w-4 mr-2"}),(0,h.format)(new Date(G.submittedAt),"PPP p")]})]}),G.confirmedAt&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.confirmed")}),(0,d.jsxs)("p",{className:"mt-1 text-gray-900 dark:text-white flex items-center",children:[(0,d.jsx)(r.CheckCircle,{className:"h-4 w-4 mr-2 text-green-500"}),(0,h.format)(new Date(G.confirmedAt),"PPP p")]})]}),G.completedAt&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.completed")}),(0,d.jsxs)("p",{className:"mt-1 text-gray-900 dark:text-white flex items-center",children:[(0,d.jsx)(r.CheckCircle,{className:"h-4 w-4 mr-2 text-emerald-500"}),(0,h.format)(new Date(G.completedAt),"PPP p")]})]}),G.closedAt&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.closed")}),(0,d.jsxs)("p",{className:"mt-1 text-gray-900 dark:text-white flex items-center",children:[(0,d.jsx)(r.CheckCircle,{className:"h-4 w-4 mr-2 text-gray-500"}),(0,h.format)(new Date(G.closedAt),"PPP p")]})]})]})]})}),(0,d.jsx)(B.BlurFade,{delay:.4,children:(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:c("requests.contactInfo")}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(m.User,{className:"h-5 w-5 text-gray-400 mr-3"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("common.name")}),(0,d.jsx)("p",{className:"text-gray-900 dark:text-white",children:G.customerName})]})]}),(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(n.Phone,{className:"h-5 w-5 text-gray-400 mr-3"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("common.phone")}),(0,d.jsx)("a",{href:`tel:${G.customerPhone}`,className:"text-primary-600 hover:text-primary-700",children:G.customerPhone})]})]}),(0,d.jsxs)("div",{className:"flex items-start",children:[(0,d.jsx)(o.MapPin,{className:"h-5 w-5 text-gray-400 mr-3 mt-1"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:c("requests.location")}),(0,d.jsx)("p",{className:"text-gray-900 dark:text-white mb-2",children:G.customerAddress}),(0,d.jsxs)("a",{href:`https://maps.google.com/maps?q=${G.customerLat},${G.customerLng}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-primary-600 hover:text-primary-700",children:[(0,d.jsx)(v.MapIcon,{className:"h-4 w-4 mr-1"}),c("common.view")," ",c("common.map")]})]})]})]})]})}),(0,d.jsx)(B.BlurFade,{delay:.5,children:(0,d.jsxs)(C.MagicCard,{className:"p-6",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:c("requests.timeline")}),(0,d.jsx)(k.default,{timeline:I.map(a=>({...a,statusNotes:a.notes,createdAt:a.timestamp,createdBy:a.changedByName?{name:a.changedByName,userType:"admin"}:void 0}))})]})})]}),(0,d.jsx)("div",{className:"space-y-6",children:(G.rating||G.feedback)&&(0,d.jsx)(B.BlurFade,{delay:.6,children:(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:c("requests.feedback")}),G.rating&&(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.rating")}),(0,d.jsxs)("div",{className:"mt-2 flex items-center",children:[[1,2,3,4,5].map(a=>(0,d.jsx)(r.CheckCircle,{className:`h-5 w-5 ${a<=G.rating?"text-yellow-400 fill-current":"text-gray-300"}`},a)),(0,d.jsxs)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:[G.rating,"/5"]})]})]}),G.feedback&&(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c("requests.feedback")}),(0,d.jsx)("p",{className:"mt-2 text-sm text-gray-900 dark:text-white",children:G.feedback})]})]})})})]})]}),(0,d.jsx)(D.default,{requestId:G.id,isOpen:M,onClose:()=>{N(!1)},onAssignSuccess:W}),O&&(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:(0,d.jsx)(B.BlurFade,{delay:.1,className:"w-full max-w-md",children:(0,d.jsxs)(C.MagicCard,{className:"p-6",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:c("requests.closeRequest")||"Close Request"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:c("requests.closeRequestConfirmation")||"Verify that the customer has confirmed the completion of this request."}),(0,d.jsx)("div",{className:"mb-4",children:(0,d.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,d.jsx)("input",{type:"checkbox",checked:S,onChange:a=>T(a.target.checked),className:"mt-1 w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,d.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:c("requests.customerConfirmedCompletion")||"Customer confirmed completion"})]})}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[c("requests.verificationNotes")||"Verification Notes"," (",c("common.optional"),")"]}),(0,d.jsx)("textarea",{value:Q,onChange:a=>R(a.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-900 dark:text-white",placeholder:c("requests.enterVerificationNotes")||"Enter verification notes..."})]}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("button",{onClick:()=>{P(!1),R(""),T(!1)},disabled:U,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 dark:text-white transition-colors disabled:opacity-50",children:c("common.cancel")}),(0,d.jsx)("button",{onClick:X,disabled:U||!S,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50",children:U?c("common.loading"):c("requests.closeRequest")})]})]})})})]}):(0,d.jsx)(i.default,{children:(0,d.jsx)("div",{className:"text-center text-red-500",children:c("errors.notFound")})})}[g,i,j,k,y,z,A,B,C,D,E]=F.then?(await F)():F,a.s(["default",()=>G]),c()}catch(a){c(a)}},!1),25181,a=>a.a(async(b,c)=>{try{var d=a.i(65898),e=a.i(24244),f=a.i(67175),g=a.i(14924),h=a.i(85634),i=a.i(22230),j=a.i(91213),k=b([h,i]);[h,i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/admin/requests/[id]",pathname:"/admin/requests/[id]",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/admin/requests/[id]",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=projects_ticketing-platform_9fcb9121._.js.map