module.exports=[94296,a=>a.a(async(b,c)=>{try{var d=a.i(8171),e=a.i(27669),f=a.i(14229),g=a.i(47750),h=a.i(75627),i=a.i(16093),j=a.i(61462),k=a.i(33292),l=a.i(62806),m=a.i(73632),n=a.i(1161),o=a.i(3750),p=a.i(81958),q=a.i(88410),r=a.i(15742),s=a.i(54006),t=a.i(88481),u=a.i(24917),v=a.i(93265),w=a.i(24413),x=a.i(7116),y=a.i(64644),z=a.i(10274),A=b([g,h,i,j,k,l,m,y,z]);function B(){let{t:a,i18n:b}=(0,g.useTranslation)("common"),c=(0,f.useRouter)(),{id:A,action:B}=c.query,{request:C,timeline:D,timeRemainingMinutes:E,isLoading:F,mutate:G}=(0,z.usePartnerRequest)(A),H=(0,z.useAcceptRequest)(),I=(0,z.useRejectRequest)(),J=(0,z.useUpdateRequestStatus)(),[K,L]=(0,e.useState)(null),[M,N]=(0,e.useState)(!1),[O,P]=(0,e.useState)(""),[Q,R]=(0,e.useState)(!1),[S,T]=(0,e.useState)(!1),[U,V]=(0,e.useState)("");(0,e.useEffect)(()=>{void 0!==E&&L(E)},[E]),(0,e.useEffect)(()=>{if(C?.status==="assigned"&&null!==K){let a=setInterval(()=>{L(a=>null===a||a<=0?0:a-1)},6e4);return()=>clearInterval(a)}},[C?.status,K]);let W=(0,e.useCallback)(async()=>{if(!S)try{T(!0),await H(A),h.toast.success(a("partner.actions.requestAccepted")),await G(),c.push("/partner/requests")}catch(c){let b=c instanceof Error?c.message:a("errors.generic");h.toast.error(b),T(!1)}},[S,H,A,a,G,c]);(0,e.useEffect)(()=>{B&&C&&"accept"===B&&"assigned"===C.status&&W()},[B,C,W]);let X=async()=>{if(!O.trim()||O.length<10)return void h.toast.error(a("partner.actions.rejectionReasonMinLength"));try{R(!0),await I(A,O),h.toast.success(a("partner.actions.requestRejected")),N(!1),c.push("/partner/requests")}catch(c){let b=c instanceof Error?c.message:a("errors.generic");h.toast.error(b),R(!1)}},Y=(0,e.useCallback)(async b=>{if(b&&b!==C?.status)try{R(!0),await J(A,b),h.toast.success(a("partner.actions.statusUpdated")),V(""),await G()}catch(c){let b=c instanceof Error?c.message:a("errors.generic");h.toast.error(b)}finally{R(!1)}},[A,J,G,a,C?.status]),Z=(0,e.useCallback)(()=>{if(!C)return[];let b=[];switch(C.status){case"confirmed":case"completed":b.push({value:"in_progress",label:a("requests.status.in_progress")||"In Progress"});break;case"in_progress":b.push({value:"completed",label:a("requests.status.completed")||"Completed"}),b.push({value:"confirmed",label:a("requests.status.confirmed")||"Confirmed"})}return b},[C,a]);if(F)return(0,d.jsx)(i.default,{children:(0,d.jsx)("div",{className:"space-y-6",children:[void 0,void 0,void 0].map((a,b)=>(0,d.jsxs)("div",{className:"animate-pulse",children:[(0,d.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4"}),(0,d.jsx)("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded"})]},b))})});if(!C)return null;let $="assigned"===C.status,_="rejected"===C.status,aa=$&&(null===K||K>0);return(0,d.jsx)(i.default,{children:(0,d.jsxs)("div",{dir:"ar"===b.language?"rtl":"ltr",className:"space-y-6",children:[(0,d.jsx)(k.BlurFade,{delay:.1,children:(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("button",{onClick:()=>c.back(),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:(0,d.jsx)(n.ArrowLeft,{className:"h-6 w-6 text-gray-600 dark:text-gray-400"})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,d.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:C.requestNumber}),(0,d.jsx)(j.default,{status:C.status})]}),(0,d.jsxs)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:[a("requests.createdAt"),":"," ",(0,x.format)(new Date(C.createdAt),"PPp")]})]})]})}),$&&null!==K&&(0,d.jsx)(k.BlurFade,{delay:.15,children:(0,d.jsxs)("div",{className:(0,y.cn)("p-4 rounded-lg border flex items-center gap-3",null===K?"text-gray-600 bg-gray-50 border-gray-200 dark:bg-gray-800 dark:border-gray-700":K<=0?"text-red-600 bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800":K<=5?"text-orange-600 bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-800":K<=10?"text-amber-600 bg-amber-50 border-amber-200 dark:bg-amber-900/20 dark:border-amber-800":"text-blue-600 bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800"),children:[(0,d.jsx)(r.Clock,{className:"h-6 w-6 shrink-0"}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"font-semibold",children:K<=0?a("partner.timer.expired"):K<=5?a("partner.timer.urgent"):a("partner.timer.confirmWithin",{minutes:15})}),(0,d.jsx)("p",{className:"text-sm",children:null===K?"":K<=0?a("partner.timer.expired"):K<1?a("partner.timer.lessThanMinute"):a("partner.timer.minutesRemaining",{minutes:K})})]})]})}),$&&!_&&(0,d.jsxs)(k.BlurFade,{delay:.2,children:[(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,d.jsxs)(l.ShimmerButton,{onClick:W,className:"flex-1 sm:flex-none",background:"rgb(34, 197, 94)",disabled:!aa||S,children:[(0,d.jsx)(s.CheckCircle2,{className:"h-5 w-5 mr-2"}),S?a("partner.actions.accepting"):a("partner.actions.accept")]}),(0,d.jsxs)("button",{onClick:()=>N(!0),disabled:!$,className:"flex-1 sm:flex-none px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,d.jsx)(t.XCircle,{className:"h-5 w-5"}),a("partner.actions.reject")]})]}),!aa&&null!==K&&K<=0&&(0,d.jsxs)("p",{className:"text-sm text-red-600 dark:text-red-400 text-center",children:[a("partner.timer.expired")," -"," ",a("requests.cannotAccept")||"Cannot accept after timer expires, but you can still reject"]})]}),!_&&("confirmed"===C.status||"in_progress"===C.status||"completed"===C.status)&&(0,d.jsx)(k.BlurFade,{delay:.2,children:(0,d.jsxs)(m.MagicCard,{className:"p-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:a("requests.changeStatus")||"Change Status"}),(0,d.jsxs)("select",{value:U,onChange:a=>{V(a.target.value),Y(a.target.value)},disabled:Q,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent dark:bg-gray-900 dark:border-gray-700 dark:text-white disabled:opacity-50",children:[(0,d.jsx)("option",{value:"",children:a("requests.selectNewStatus")||"Select new status..."}),Z().map(a=>(0,d.jsx)("option",{value:a.value,children:a.label},a.value))]}),Q&&(0,d.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:a("common.updating")||"Updating..."})]})}),_&&(0,d.jsx)(k.BlurFade,{delay:.2,children:(0,d.jsx)(m.MagicCard,{className:"p-6 bg-red-50 dark:bg-red-900/10 border-2 border-red-200 dark:border-red-800",children:(0,d.jsxs)("div",{className:"flex items-start gap-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)(t.XCircle,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-200 mb-2",children:a("partner.requests.rejectedTitle")||"Request Rejected"}),(0,d.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300 mb-2",children:a("partner.requests.rejectedMessage")||"This request has been rejected and is now read-only. No further actions can be taken."}),C.rejectionReason&&(0,d.jsxs)("div",{className:"mt-3 p-3 bg-white dark:bg-red-900/20 rounded-lg",children:[(0,d.jsxs)("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1",children:[a("requests.rejectionReason"),":"]}),(0,d.jsx)("p",{className:"text-sm text-gray-900 dark:text-white",children:C.rejectionReason})]})]})]})})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,d.jsx)(k.BlurFade,{delay:.25,children:(0,d.jsxs)(m.MagicCard,{className:"p-6",children:[(0,d.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,d.jsx)(q.User,{className:"h-5 w-5 text-primary-600"}),a("requests.customerInfo")||"Customer Information"]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)(q.User,{className:"h-5 w-5 text-gray-400 mt-0.5 shrink-0"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("common.name")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:C.customerName})]})]}),(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)(p.Phone,{className:"h-5 w-5 text-gray-400 mt-0.5 shrink-0"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("common.phone")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",dir:"ltr",children:C.customerPhone})]})]}),(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)(o.MapPin,{className:"h-5 w-5 text-gray-400 mt-0.5 shrink-0"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("common.address")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:C.customerAddress}),(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:[a("branches.coordinates"),": ",C.customerLat,","," ",C.customerLng]})]})]})]})]})}),(0,d.jsx)(k.BlurFade,{delay:.3,children:(0,d.jsxs)(m.MagicCard,{className:"p-6",children:[(0,d.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,d.jsx)(w.Package,{className:"h-5 w-5 text-primary-600"}),a("requests.serviceDetails")||"Service Details"]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("categories.title")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"ar"===b.language?C.categoryNameAr:C.categoryName})]}),C.serviceName&&(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("services.title")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"ar"===b.language?C.serviceNameAr:C.serviceName})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("partners.pickupOptions")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:C.pickupOption})]})]})]})}),C.branchId&&(0,d.jsx)(k.BlurFade,{delay:.35,children:(0,d.jsxs)(m.MagicCard,{className:"p-6",children:[(0,d.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,d.jsx)(v.Building2,{className:"h-5 w-5 text-primary-600"}),a("branches.assignedBranch")||"Assigned Branch"]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("branches.branchName")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"ar"===b.language&&C.branchNameAr?C.branchNameAr:C.branchName})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("common.address")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:C.branchAddress})]}),C.branchPhone&&(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("common.phone")}),(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",dir:"ltr",children:C.branchPhone})]})]})]})}),(0,d.jsx)(k.BlurFade,{delay:.4,children:(0,d.jsxs)(m.MagicCard,{className:"p-6",children:[(0,d.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,d.jsx)(r.Clock,{className:"h-5 w-5 text-primary-600"}),a("partner.requests.timeline")]}),(0,d.jsx)("div",{className:"space-y-4",children:D&&D.length>0?D.map((a,b)=>(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsxs)("div",{className:"flex flex-col items-center",children:[(0,d.jsx)("div",{className:(0,y.cn)("w-3 h-3 rounded-full",0===b?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600")}),b<D.length-1&&(0,d.jsx)("div",{className:"w-0.5 h-full bg-gray-200 dark:bg-gray-700 mt-1"})]}),(0,d.jsxs)("div",{className:"flex-1 pb-4",children:[(0,d.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:a.status}),(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:[(0,x.format)(new Date(a.timestamp),"PPp"),a.changedByName&&` â€¢ ${a.changedByName}`]}),a.notes&&(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:a.notes})]})]},a.id)):(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:a("partner.requests.noTimeline")})})]})})]}),M&&(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:(0,d.jsx)(k.BlurFade,{delay:.1,className:"w-full max-w-2xl",children:(0,d.jsxs)(m.MagicCard,{className:"p-8 bg-gradient-to-br from-white to-red-50/30 dark:from-gray-900 dark:to-red-900/10",children:[(0,d.jsxs)("div",{className:"text-center mb-6",children:[(0,d.jsx)("div",{className:"inline-flex p-4 bg-gradient-to-br from-red-500 to-red-600 rounded-full shadow-lg shadow-red-500/50 mb-4",children:(0,d.jsx)(t.XCircle,{className:"w-12 h-12 text-white"})}),(0,d.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 to-red-500 bg-clip-text text-transparent mb-2",children:a("partner.actions.reject")}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:a("partner.actions.rejectConfirm")})]}),(0,d.jsxs)("div",{className:"mb-6 p-4 bg-white/50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:a("requests.requestNumber")}),(0,d.jsx)("span",{className:"font-bold text-gray-900 dark:text-white",children:C?.requestNumber})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:a("requests.customer")}),(0,d.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:C?.customerName})]})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:[a("partner.actions.rejectionReason")," *"]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("textarea",{value:O,onChange:a=>P(a.target.value),rows:5,className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-red-500/20 focus:border-red-500 dark:bg-gray-800 dark:text-white transition-all resize-none",placeholder:a("partner.actions.rejectionReasonPlaceholder"),required:!0,minLength:10}),(0,d.jsx)("div",{className:"absolute bottom-3 right-3",children:(0,d.jsxs)("span",{className:(0,y.cn)("text-xs font-medium",O.length>=10?"text-green-600 dark:text-green-400":"text-gray-400 dark:text-gray-500"),children:[O.length,"/10"]})})]}),(0,d.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 flex items-center gap-1",children:[(0,d.jsx)(u.AlertCircle,{className:"w-3 h-3"}),a("common.minimum")," 10 ",a("common.characters")]})]}),(0,d.jsxs)("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-start gap-3",children:[(0,d.jsx)(u.AlertCircle,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),(0,d.jsxs)("div",{className:"text-sm text-red-800 dark:text-red-300",children:[(0,d.jsx)("p",{className:"font-semibold mb-1",children:a("partner.actions.rejectWarningTitle")||"Important"}),(0,d.jsx)("p",{children:a("partner.actions.rejectWarningText")||"This action cannot be undone. The request will be returned to unassigned status."})]})]}),(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("button",{onClick:()=>{N(!1),P(""),"reject"===B&&c.push(`/partner/requests/${A}`,void 0,{shallow:!0})},disabled:Q,className:"flex-1 px-6 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 dark:text-white transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:a("common.cancel")}),(0,d.jsx)(l.ShimmerButton,{onClick:X,disabled:Q||O.length<10,className:"flex-1 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-700 hover:to-red-600 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,d.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,d.jsx)(t.XCircle,{className:"w-5 h-5"}),(0,d.jsx)("span",{className:"font-semibold",children:Q?a("partner.actions.rejecting"):a("partner.actions.reject")})]})})]})]})})})]})})}[g,h,i,j,k,l,m,y,z]=A.then?(await A)():A,a.s(["default",()=>B]),c()}catch(a){c(a)}},!1),43568,a=>a.a(async(b,c)=>{try{var d=a.i(65898),e=a.i(24244),f=a.i(67175),g=a.i(14924),h=a.i(85634),i=a.i(94296),j=a.i(91213),k=b([h,i]);[h,i]=k.then?(await k)():k;let l=(0,f.hoist)(i,"default"),m=(0,f.hoist)(i,"getStaticProps"),n=(0,f.hoist)(i,"getStaticPaths"),o=(0,f.hoist)(i,"getServerSideProps"),p=(0,f.hoist)(i,"config"),q=(0,f.hoist)(i,"reportWebVitals"),r=(0,f.hoist)(i,"unstable_getStaticProps"),s=(0,f.hoist)(i,"unstable_getStaticPaths"),t=(0,f.hoist)(i,"unstable_getStaticParams"),u=(0,f.hoist)(i,"unstable_getServerProps"),v=(0,f.hoist)(i,"unstable_getServerSideProps"),w=new d.PagesRouteModule({definition:{kind:e.RouteKind.PAGES,page:"/partner/requests/[id]",pathname:"/partner/requests/[id]",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:h.default,Document:g.default},userland:i}),x=(0,j.getHandler)({srcPage:"/partner/requests/[id]",config:p,userland:i,routeModule:w,getStaticPaths:n,getStaticProps:m,getServerSideProps:o});a.s(["config",0,p,"default",0,l,"getServerSideProps",0,o,"getStaticPaths",0,n,"getStaticProps",0,m,"handler",0,x,"reportWebVitals",0,q,"routeModule",0,w,"unstable_getServerProps",0,u,"unstable_getServerSideProps",0,v,"unstable_getStaticParams",0,t,"unstable_getStaticPaths",0,s,"unstable_getStaticProps",0,r]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=projects_ticketing-platform_42dda5e5._.js.map