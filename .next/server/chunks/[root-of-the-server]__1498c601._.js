module.exports=[70406,(e,t,s)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},97010,e=>e.a(async(t,s)=>{try{let t=await e.y("zod");e.n(t),s()}catch(e){s(e)}},!0),20270,(e,t,s)=>{t.exports=e.x("dotenv/config",()=>require("dotenv/config"))},21783,e=>e.a(async(t,s)=>{try{let t=await e.y("drizzle-orm/postgres-js");e.n(t),s()}catch(e){s(e)}},!0),55443,e=>e.a(async(t,s)=>{try{let t=await e.y("postgres");e.n(t),s()}catch(e){s(e)}},!0),88707,e=>e.a(async(t,s)=>{try{e.i(20270);var r=e.i(21783),i=e.i(55443),n=t([r,i]);[r,i]=n.then?(await n)():n;let o=process.env.DATABASE_URL;if(!o)throw Error("DATABASE_URL environment variable is not set");let a=(0,i.default)(o,{prepare:!1,max:10,idle_timeout:20,connect_timeout:30,max_lifetime:1800,connection:{application_name:"ticketing-system"},onnotice:()=>{},debug:void 0}),p=(0,r.drizzle)(a);"undefined"!=typeof process&&(process.on("SIGTERM",async()=>{console.log("SIGTERM received, closing database connections..."),await a.end({timeout:5})}),process.on("SIGINT",async()=>{console.log("SIGINT received, closing database connections..."),await a.end({timeout:5})})),e.s(["db",0,p]),s()}catch(e){s(e)}},!1),3781,e=>{"use strict";class t{isDevelopment=!1;logLevel=process.env.LOG_LEVEL||"info";shouldLog(e){let t={debug:0,info:1,warn:2,error:3};return t[e]>=t[this.logLevel]}formatLog(e){let{level:t,message:s,timestamp:r,context:i,userId:n,requestId:o}=e,a=`[${r}] [${t.toUpperCase()}]`;return n&&(a+=` [USER:${n}]`),o&&(a+=` [REQ:${o}]`),a+=` ${s}`,i&&Object.keys(i).length>0&&(a+=` | Context: ${JSON.stringify(i)}`),a}log(e,t,s,r,i){if(!this.shouldLog(e))return;let n={level:e,message:t,timestamp:new Date().toISOString(),context:s,userId:r,requestId:i},o=this.formatLog(n);this.isDevelopment?console.log(`${{debug:"\x1b[36m",info:"\x1b[32m",warn:"\x1b[33m",error:"\x1b[31m"}[e]}${o}\x1b[0m`):console.log(JSON.stringify(n))}debug(e,t,s,r){this.log("debug",e,t,s,r)}info(e,t,s,r){this.log("info",e,t,s,r)}warn(e,t,s,r){this.log("warn",e,t,s,r)}error(e,t,s,r){this.log("error",e,t,s,r)}apiRequest(e,t,s,r,i){this.info(`API Request: ${e} ${t}`,{method:e,url:t,...s},r,i)}apiResponse(e,t,s,r,i,n){this.info(`API Response: ${e} ${t} - ${s} (${r}ms)`,{method:e,url:t,statusCode:s,duration:r},i,n)}databaseQuery(e,t,s,r){this.debug(`Database Query: ${e} (${t}ms)`,{query:e,duration:t},s,r)}authEvent(e,t,s,r){this.info(`Auth Event: ${e}`,{event:e,...s},t,r)}businessEvent(e,t,s,r,i,n){this.info(`Business Event: ${e}`,{event:e,entityType:t,entityId:s,...i},r,n)}errorEvent(e,t,s,r){this.error(`Error Event: ${e.message}`,{error:e.message,stack:e.stack,...t},s,r)}}let s=new t;e.s(["default",0,s,"logger",0,s])},85278,e=>e.a(async(t,s)=>{try{var r=e.i(97010),i=t([r]);[r]=i.then?(await i)():i;class p extends Error{statusCode;code;details;constructor(e,t=500,s,r){super(e),this.statusCode=t,this.code=s,this.details=r,this.name="AppError"}}function n(e){if(e instanceof p)return{message:e.message,code:e.code,statusCode:e.statusCode,details:e.details};if(e instanceof r.ZodError){let t=e.issues.map(e=>({field:e.path.join("."),message:e.message,code:e.code}));return{message:`Validation error: ${t.map(e=>`${e.field}: ${e.message}`).join(", ")}`,code:"VALIDATION_ERROR",statusCode:400,details:t.reduce((e,t)=>(e[t.field]=t.message,e),{})}}return e instanceof Error?{message:e.message,statusCode:500}:{message:"Internal server error",statusCode:500}}function o(e,t){let{statusCode:s,message:r,code:i,details:n={}}=t;e.status(s).json({success:!1,error:{message:r,code:i,details:n},timestamp:new Date().toISOString()})}function a(e,t,s=200){e.status(s).json({success:!0,data:t,timestamp:new Date().toISOString()})}e.s(["AppError",()=>p,"ErrorCodes",0,{VALIDATION_ERROR:"VALIDATION_ERROR",AUTHENTICATION_ERROR:"AUTHENTICATION_ERROR",AUTHORIZATION_ERROR:"AUTHORIZATION_ERROR",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",NOT_FOUND:"NOT_FOUND",DUPLICATE_ENTRY:"DUPLICATE_ENTRY",INVALID_CREDENTIALS:"INVALID_CREDENTIALS",TOKEN_EXPIRED:"TOKEN_EXPIRED",TOKEN_INVALID:"TOKEN_INVALID",USER_NOT_FOUND:"USER_NOT_FOUND",PARTNER_NOT_FOUND:"PARTNER_NOT_FOUND",REQUEST_NOT_FOUND:"REQUEST_NOT_FOUND",BRANCH_NOT_FOUND:"BRANCH_NOT_FOUND",CATEGORY_NOT_FOUND:"CATEGORY_NOT_FOUND",SERVICE_NOT_FOUND:"SERVICE_NOT_FOUND",INVALID_STATUS_TRANSITION:"INVALID_STATUS_TRANSITION",SLA_TIMEOUT:"SLA_TIMEOUT",CONFIGURATION_NOT_FOUND:"CONFIGURATION_NOT_FOUND"},"handleApiError",()=>n,"sendErrorResponse",()=>o,"sendSuccessResponse",()=>a]),s()}catch(e){s(e)}},!1),19071,e=>e.a(async(t,s)=>{try{var r=e.i(88707),i=e.i(78156),n=e.i(89722),o=e.i(85278),a=e.i(3781),p=t([r,i,n,o]);async function c(e,t){if("GET"!==e.method)return t.status(405).json({message:"Method not allowed"});try{let s=await r.db.select({id:i.pickupOptionTypes.id,name:i.pickupOptionTypes.name,nameAr:i.pickupOptionTypes.nameAr,description:i.pickupOptionTypes.description,descriptionAr:i.pickupOptionTypes.descriptionAr,requiresServiceSelection:i.pickupOptionTypes.requiresServiceSelection,isActive:i.pickupOptionTypes.isActive,createdAt:i.pickupOptionTypes.createdAt,updatedAt:i.pickupOptionTypes.updatedAt}).from(i.pickupOptionTypes).where((0,n.eq)(i.pickupOptionTypes.isActive,!0)).orderBy(i.pickupOptionTypes.name);return a.logger.apiResponse(e.method,e.url,200,0,void 0,e.headers["x-request-id"]),(0,o.sendSuccessResponse)(t,s)}catch(r){let s=(0,o.handleApiError)(r);return a.logger.error("Pickup options API error",{error:s.message,code:s.code,requestId:e.headers["x-request-id"]}),(0,o.sendErrorResponse)(t,s)}}[r,i,n,o]=p.then?(await p)():p,e.s(["default",()=>c]),s()}catch(e){s(e)}},!1),97968,e=>e.a(async(t,s)=>{try{var r=e.i(89304),i=e.i(36438),n=e.i(90950),o=e.i(17885),a=e.i(19071),p=e.i(8911),c=e.i(95011),d=e.i(40430),l=t([a]);[a]=l.then?(await l)():l;let O=(0,o.hoist)(a,"default"),T=(0,o.hoist)(a,"config"),E=new n.PagesAPIRouteModule({definition:{kind:i.RouteKind.PAGES_API,page:"/api/pickup-options",pathname:"/api/pickup-options",bundlePath:"",filename:""},userland:a,distDir:".next",relativeProjectDir:""});async function u(e,t,s){E.isDev&&(0,d.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/pickup-options";i=i.replace(/\/index$/,"")||"/";let n=await E.prepare(e,t,{srcPage:i});if(!n){t.statusCode=400,t.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve());return}let{query:o,params:a,prerenderManifest:l,routerServerContext:u}=n;try{let s=e.method||"GET",r=(0,p.getTracer)(),n=r.getActiveScopeSpan(),d=E.instrumentationOnRequestError.bind(E),O=async n=>E.render(e,t,{query:{...o,...a},params:a,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:E.isDev,page:"/api/pickup-options",internalRevalidate:null==u?void 0:u.revalidate,onError:(...t)=>d(e,...t)}).finally(()=>{if(!n)return;n.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let e=r.getRootSpanAttributes();if(!e)return;if(e.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${e.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=e.get("next.route");if(o){let e=`${s} ${o}`;n.setAttributes({"next.route":o,"http.route":o,"next.span_name":e}),n.updateName(e)}else n.updateName(`${s} ${i}`)});n?await O(n):await r.withPropagatedContext(e.headers,()=>r.trace(c.BaseServerSpan.handleRequest,{spanName:`${s} ${i}`,kind:p.SpanKind.SERVER,attributes:{"http.method":s,"http.target":e.url}},O))}catch(e){if(E.isDev)throw e;(0,r.sendError)(t,500,"Internal Server Error")}finally{null==s.waitUntil||s.waitUntil.call(s,Promise.resolve())}}e.s(["config",0,T,"default",0,O,"handler",()=>u]),s()}catch(e){s(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__1498c601._.js.map